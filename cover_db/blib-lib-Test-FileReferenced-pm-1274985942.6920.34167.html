<html>
<head>
<title>Coverage: blib/lib/Test/FileReferenced.pm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link media=screen href="cover_report.css" rel="stylesheet" type="text/css" />
</style>
</head>
<body>
<h1>Coverage: blib/lib/Test/FileReferenced.pm</h1>
Overall file coverage:<br><table><tr><th>Line</td><th>St.</td><th>Br.</td><th>Cond.</td><th>Sub.</td><th>POD</td><th>Time</td><th>Source code</td></tr>
<tr><td class=head>1</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src># Copyright 2010, Bartłomiej Syguła (natanael@natanael.krakow.pl)
</td></tr><tr><td class=head>2</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>#
</td></tr><tr><td class=head>3</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src># This is free software. It is licensed, and can be distributed under the same terms as Perl itself.
</td></tr><tr><td class=head>4</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>#
</td></tr><tr><td class=head>5</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src># For more, see my website: http://natanael.krakow.pl/
</td></tr><tr><td class=head>6</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>7</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>package Test::FileReferenced;
</td></tr><tr><td class=head>8</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>9</td><td><div class=c4>1</div><div class=c4>1</div><div class=c4>1</div></td><td></td><td></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-subroutine.html#9" class=c4>1</a></td><td></td><td></td><td class=src>use 5.005003;
</td></tr><tr><td class=head>10</td><td><div class=c4>1</div><div class=c4>1</div><div class=c4>1</div></td><td></td><td></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-subroutine.html#10" class=c4>1</a></td><td></td><td></td><td class=src>use strict;
</td></tr><tr><td class=head>11</td><td><div class=c4>1</div><div class=c4>1</div><div class=c4>1</div></td><td></td><td></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-subroutine.html#11" class=c4>1</a></td><td></td><td></td><td class=src>use base qw( Exporter );
</td></tr><tr><td class=head>12</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>13</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>our $VERSION = '0.01';
</td></tr><tr><td class=head>14</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>our @EXPORT = qw(
</td></tr><tr><td class=head>15</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    is_referenced_ok
</td></tr><tr><td class=head>16</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    is_referenced_in_file
</td></tr><tr><td class=head>17</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>);
</td></tr><tr><td class=head>18</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>our @EXPORT_OK = qw(
</td></tr><tr><td class=head>19</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    set_serializer
</td></tr><tr><td class=head>20</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    at_exit
</td></tr><tr><td class=head>21</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>);
</td></tr><tr><td class=head>22</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>23</td><td><div class=c4>1</div><div class=c4>1</div><div class=c4>1</div></td><td></td><td></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-subroutine.html#23" class=c4>1</a></td><td></td><td></td><td class=src>use Carp qw( croak );
</td></tr><tr><td class=head>24</td><td><div class=c4>1</div><div class=c4>1</div><div class=c4>1</div></td><td></td><td></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-subroutine.html#24" class=c4>1</a></td><td></td><td></td><td class=src>use English qw( -no_match_vars );
</td></tr><tr><td class=head>25</td><td><div class=c4>1</div><div class=c4>1</div><div class=c4>1</div></td><td></td><td></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-subroutine.html#25" class=c4>1</a></td><td></td><td></td><td class=src>use FindBin qw( $Bin );
</td></tr><tr><td class=head>26</td><td><div class=c4>1</div><div class=c4>1</div><div class=c4>1</div></td><td></td><td></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-subroutine.html#26" class=c4>1</a></td><td></td><td></td><td class=src>use Test::More;
</td></tr><tr><td class=head>27</td><td><div class=c4>1</div><div class=c4>1</div><div class=c4>1</div></td><td></td><td></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-subroutine.html#27" class=c4>1</a></td><td></td><td></td><td class=src>use YAML::Any qw( LoadFile DumpFile );
</td></tr><tr><td class=head>28</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>29</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=encoding UTF-8
</td></tr><tr><td class=head>30</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>31</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=head1 NAME
</td></tr><tr><td class=head>32</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>33</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Test::FileReferenced - Test against reference data stored in file(s).
</td></tr><tr><td class=head>34</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>35</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=head1 SYNOPSIS
</td></tr><tr><td class=head>36</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>37</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> use Test::FileReferenced;
</td></tr><tr><td class=head>38</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> 
</td></tr><tr><td class=head>39</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> # Optional:
</td></tr><tr><td class=head>40</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> Test::FileReferenced::set_serializer('mydump', \&amp;My::Dumper::Load, \&amp;My::Dumper::Dump);
</td></tr><tr><td class=head>41</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> 
</td></tr><tr><td class=head>42</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> is_referenced_ok( complex_data_structure(), "complex data structure" );
</td></tr><tr><td class=head>43</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> 
</td></tr><tr><td class=head>44</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> is_referenced_in_file ( data_structure(), "data structure", "data_structure" );
</td></tr><tr><td class=head>45</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> 
</td></tr><tr><td class=head>46</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> # Optional:
</td></tr><tr><td class=head>47</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> Test::FileReferenced::at_exit();
</td></tr><tr><td class=head>48</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>49</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=head1 DESCRIPTION
</td></tr><tr><td class=head>50</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>51</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Test::FileReferenced helps testing routines returning complex data structures.
</td></tr><tr><td class=head>52</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>This is achieved by serializing test's output (by default using YAML::Syck),
</td></tr><tr><td class=head>53</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>and allowing the Developer to compare it with reference data.
</td></tr><tr><td class=head>54</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>55</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>In case there are differences between reference and actual result,
</td></tr><tr><td class=head>56</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>comparison can be made using traditional UNIX diff-like (diff, vimdiff, gvimdiff, kdiff) utilities.
</td></tr><tr><td class=head>57</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>58</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>In such case, Test::FileReferenced - after the test completes - will ask the Developer to run diff on result and reference data.
</td></tr><tr><td class=head>59</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>If all differences ware intended, Developer may just replace reference data with actual test results.
</td></tr><tr><td class=head>60</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>61</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=cut
</td></tr><tr><td class=head>62</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>63</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>my $serializer_ext = 'yaml';
</td></tr><tr><td class=head>64</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>my $serializer_load = \&amp;LoadFile;
</td></tr><tr><td class=head>65</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>my $serializer_dump = \&amp;DumpFile;
</td></tr><tr><td class=head>66</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>67</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>my $default_reference_filename;
</td></tr><tr><td class=head>68</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>my $default_results_filename;
</td></tr><tr><td class=head>69</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>70</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src># Data storeage:
</td></tr><tr><td class=head>71</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>my $reference = undef; # Becomes {} once initialized.
</td></tr><tr><td class=head>72</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>my $output    = {};
</td></tr><tr><td class=head>73</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>74</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src># Flags:
</td></tr><tr><td class=head>75</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>my $exited_cleanly = 0;
</td></tr><tr><td class=head>76</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>my $failure_count  = 0;
</td></tr><tr><td class=head>77</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>78</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>END {
</td></tr><tr><td class=head>79</td><td><div class=c4>1</div></td><td></td><td></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-subroutine.html#79" class=c4>1</a></td><td></td><td></td><td class=src>    at_exit();
</td></tr><tr><td class=head>80</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>}
</td></tr><tr><td class=head>81</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>82</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=head1 SUBROUTINES
</td></tr><tr><td class=head>83</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>84</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=over
</td></tr><tr><td class=head>85</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>86</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=item is_referenced_ok ( $data, $name, $comparator )
</td></tr><tr><td class=head>87</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>88</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Compare C&lt;$data&gt; with reference stored under key C&lt;$name&gt; in default reference file.
</td></tr><tr><td class=head>89</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>90</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>If C&lt;$comparator&gt; is a CODE reference, it is used to compare results. If this parameter is not given, Test::More::is_deeply is used.
</td></tr><tr><td class=head>91</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>92</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Parameters:
</td></tr><tr><td class=head>93</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>$data (tested data, undef, scalar or reference)
</td></tr><tr><td class=head>94</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>$name (unlike usual Test::* routines, it is mandatory)
</td></tr><tr><td class=head>95</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>$comparator (optional)
</td></tr><tr><td class=head>96</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>97</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Returns:
</td></tr><tr><td class=head>98</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Value returned by comparizon routine. By default (when is_deeply is used)
</td></tr><tr><td class=head>99</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>it will be C&lt;1&gt; if the test passed, and C&lt;0&gt; if it failed.
</td></tr><tr><td class=head>100</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>101</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=cut
</td></tr><tr><td class=head>102</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>103</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>sub is_referenced_ok { # {{{
</td></tr><tr><td class=head>104</td><td><div class=c4>3</div></td><td></td><td></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-subroutine.html#104" class=c4>3</a></td><td><div class=c4>1</div></td><td></td><td class=src>    my ( $tested_data, $test_name, $comparator ) = @_;
</td></tr><tr><td class=head>105</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>106</td><td><div class=c4>3</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>    _init_if_you_need();
</td></tr><tr><td class=head>107</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>108</td><td><div class=c4>3</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>    _load_reference_if_you_need();
</td></tr><tr><td class=head>109</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>110</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    # Test name is mandatory, since without it, it's hard to reliably
</td></tr><tr><td class=head>111</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    # identify reference output in the reference file.
</td></tr><tr><td class=head>112</td><td><div class=c4>3</div></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-branch.html#112" class=c1>50</a></td><td></td><td></td><td></td><td></td><td class=src>    if (not $test_name) {
</td></tr><tr><td class=head>113</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        croak("Test name missing, but it is mandatory!");
</td></tr><tr><td class=head>114</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    }
</td></tr><tr><td class=head>115</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>116</td><td><div class=c4>3</div></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-branch.html#116" class=c1>50</a></td><td></td><td></td><td></td><td></td><td class=src>    if (not $comparator) {
</td></tr><tr><td class=head>117</td><td><div class=c4>3</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        $comparator = \&amp;is_deeply;
</td></tr><tr><td class=head>118</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    }
</td></tr><tr><td class=head>119</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>120</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    # Check if We have a reference data for given test.
</td></tr><tr><td class=head>121</td><td><div class=c4>3</div></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-branch.html#121" class=c1>50</a></td><td></td><td></td><td></td><td></td><td class=src>    if (not $reference-&gt;{$test_name}) {
</td></tr><tr><td class=head>122</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        diag("No reference for test '$test_name' found. Test will fail.");
</td></tr><tr><td class=head>123</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>124</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>        # Fixme: provide some more detailed information, what happened,
</td></tr><tr><td class=head>125</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>        # and how to react. But, display it only on first occurance.
</td></tr><tr><td class=head>126</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>127</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        $failure_count++;
</td></tr><tr><td class=head>128</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>129</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        return fail($test_name);
</td></tr><tr><td class=head>130</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    }
</td></tr><tr><td class=head>131</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>132</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    # Check if the test name is unique.
</td></tr><tr><td class=head>133</td><td><div class=c4>3</div></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-branch.html#133" class=c4>100</a></td><td></td><td></td><td></td><td></td><td class=src>    if ($output-&gt;{$test_name}) {
</td></tr><tr><td class=head>134</td><td><div class=c4>1</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        croak("Test name: '$test_name' is not unique.");
</td></tr><tr><td class=head>135</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    }
</td></tr><tr><td class=head>136</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>137</td><td><div class=c4>2</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>    $output-&gt;{$test_name} = $tested_data;
</td></tr><tr><td class=head>138</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>139</td><td><div class=c4>2</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>    my $status;
</td></tr><tr><td class=head>140</td><td><div class=c4>2</div></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-branch.html#140" class=c1>50</a></td><td></td><td></td><td></td><td></td><td class=src>    if (not $status = $comparator-&gt;($tested_data, $reference-&gt;{$test_name}, $test_name)) {
</td></tr><tr><td class=head>141</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        $failure_count++;
</td></tr><tr><td class=head>142</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    }
</td></tr><tr><td class=head>143</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>144</td><td><div class=c4>2</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>    return $status;
</td></tr><tr><td class=head>145</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>} # }}}
</td></tr><tr><td class=head>146</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>147</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=item is_referenced_in_file ( $data, $name, $file_basename )
</td></tr><tr><td class=head>148</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>149</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Compare C&lt;$data&gt; with reference stored in custom file: F&lt;$file_basename.yaml&gt; (assuming the serializer is YAML::Syck).
</td></tr><tr><td class=head>150</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>151</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>If C&lt;$comparator&gt; is a CODE reference, it is used to compare results. If this parameter is not given, Test::More::is_deeply is used.
</td></tr><tr><td class=head>152</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>153</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=cut
</td></tr><tr><td class=head>154</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>155</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>sub is_referenced_in_file { # {{{
</td></tr><tr><td class=head>156</td><td><div class=c0>0</div></td><td></td><td></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-subroutine.html#156" class=c0>0</a></td><td><div class=c4>1</div></td><td></td><td class=src>    my ( $tested_data, $reference_filename, $test_name, $comparator ) = @_;
</td></tr><tr><td class=head>157</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>158</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>    _init_if_you_need();
</td></tr><tr><td class=head>159</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>160</td><td><div class=c0>0</div></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-branch.html#160" class=c0>0</a></td><td></td><td></td><td></td><td></td><td class=src>    if (not $comparator) {
</td></tr><tr><td class=head>161</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        $comparator = \&amp;is_deeply;
</td></tr><tr><td class=head>162</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    }
</td></tr><tr><td class=head>163</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>164</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    # Construct path to reference file.
</td></tr><tr><td class=head>165</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>    my ($reference_path, $output_path );
</td></tr><tr><td class=head>166</td><td><div class=c0>0</div></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-branch.html#166" class=c0>0</a></td><td></td><td></td><td></td><td></td><td class=src>    if ($reference_filename =~ m{^[\\\/]}s) {
</td></tr><tr><td class=head>167</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        $reference_path = $reference_filename . q{.}        . $serializer_ext;
</td></tr><tr><td class=head>168</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        $output_path    = $reference_filename . q{-result.} . $serializer_ext;
</td></tr><tr><td class=head>169</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    }
</td></tr><tr><td class=head>170</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    else {
</td></tr><tr><td class=head>171</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        $reference_path = $Bin . q{/} . $reference_filename . q{.}        . $serializer_ext;
</td></tr><tr><td class=head>172</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        $output_path    = $Bin . q{/} . $reference_filename . q{-result.} . $serializer_ext;
</td></tr><tr><td class=head>173</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    }
</td></tr><tr><td class=head>174</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>175</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    # Load reference data.
</td></tr><tr><td class=head>176</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>    my $reference_data = $serializer_load-&gt;($reference_path);
</td></tr><tr><td class=head>177</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>178</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>    my $status;
</td></tr><tr><td class=head>179</td><td><div class=c0>0</div></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-branch.html#179" class=c0>0</a></td><td></td><td></td><td></td><td></td><td class=src>    if (not $status = $comparator-&gt;($tested_data, $reference_data, $test_name)) {
</td></tr><tr><td class=head>180</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        $serializer_dump-&gt;($output_path, $tested_data);
</td></tr><tr><td class=head>181</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>182</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        $failure_count++;
</td></tr><tr><td class=head>183</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>184</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>        # Test failed, display prompt....
</td></tr><tr><td class=head>185</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>        # W.I.P. (WIP!)
</td></tr><tr><td class=head>186</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    }
</td></tr><tr><td class=head>187</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    else {
</td></tr><tr><td class=head>188</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>        # If there are output files from previous run - clear them up.
</td></tr><tr><td class=head>189</td><td><div class=c0>0</div></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-branch.html#189" class=c0>0</a></td><td></td><td></td><td></td><td></td><td class=src>        if (-e $output_path) {
</td></tr><tr><td class=head>190</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>            unlink $output_path;
</td></tr><tr><td class=head>191</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>        }
</td></tr><tr><td class=head>192</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    }
</td></tr><tr><td class=head>193</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>194</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>    return $status;
</td></tr><tr><td class=head>195</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>} # }}}
</td></tr><tr><td class=head>196</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>197</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=item set_serializer ( $extension, $load_coderef, $dump_coderef )
</td></tr><tr><td class=head>198</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>199</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Changes default serializing functions to ones provided by the Developer. C&lt;$extension&gt; must also be provided, so Test::FileReferenced can
</td></tr><tr><td class=head>200</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>automatically create the default reference file, if needed.
</td></tr><tr><td class=head>201</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>202</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>You do not need to use this function, if You are happy with YAML::Syck usage.
</td></tr><tr><td class=head>203</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>204</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=cut
</td></tr><tr><td class=head>205</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>206</td><td><div class=c0>0</div></td><td></td><td></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-subroutine.html#206" class=c0>0</a></td><td><div class=c4>1</div></td><td></td><td class=src>sub set_serializer { # {{{
</td></tr><tr><td class=head>207</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>} # }}}
</td></tr><tr><td class=head>208</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>209</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=item at_exit ()
</td></tr><tr><td class=head>210</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>211</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>If there ware failed tests, C&lt;at_exit()&gt; will dump results from the test in temporary file, and then prompt to inspect changes.
</td></tr><tr><td class=head>212</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>213</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>If there ware no failures, C&lt;at_exit()&gt; will check, if results file (from any previous run) exists, and if so - remove it.
</td></tr><tr><td class=head>214</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Nothing will be printed in this case.
</td></tr><tr><td class=head>215</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>216</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Normally this function does not need to be run explicitly, as Test::FileReferenced will run it from it's C&lt;END {}&gt; sections.
</td></tr><tr><td class=head>217</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>218</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Parameters:
</td></tr><tr><td class=head>219</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>none
</td></tr><tr><td class=head>220</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>221</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Returns:
</td></tr><tr><td class=head>222</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>undef
</td></tr><tr><td class=head>223</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>224</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=cut
</td></tr><tr><td class=head>225</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>226</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>sub at_exit { # {{{
</td></tr><tr><td class=head>227</td><td><div class=c4>1</div></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-branch.html#227" class=c1>50</a></td><td></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-subroutine.html#227" class=c4>1</a></td><td><div class=c4>1</div></td><td></td><td class=src>    if ($exited_cleanly) {
</td></tr><tr><td class=head>228</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        return;
</td></tr><tr><td class=head>229</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    }
</td></tr><tr><td class=head>230</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>231</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    # Ware there any failures?
</td></tr><tr><td class=head>232</td><td><div class=c4>1</div></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-branch.html#232" class=c1>50</a></td><td></td><td></td><td></td><td></td><td class=src>    if ($failure_count &gt; 0) {
</td></tr><tr><td class=head>233</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        $serializer_dump-&gt;($default_results_filename, $output);
</td></tr><tr><td class=head>234</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>        
</td></tr><tr><td class=head>235</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        _display_failure_prompt();
</td></tr><tr><td class=head>236</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    }
</td></tr><tr><td class=head>237</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    else {
</td></tr><tr><td class=head>238</td><td><div class=c4>1</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        _clean_up();
</td></tr><tr><td class=head>239</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    }
</td></tr><tr><td class=head>240</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>241</td><td><div class=c4>1</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>    $exited_cleanly = 1;
</td></tr><tr><td class=head>242</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>243</td><td><div class=c4>1</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>    return;
</td></tr><tr><td class=head>244</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>} # }}}
</td></tr><tr><td class=head>245</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>246</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src># Strictly internal routines.
</td></tr><tr><td class=head>247</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>#
</td></tr><tr><td class=head>248</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src># (please DO NOT use, for Your own comfort and safety)
</td></tr><tr><td class=head>249</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>250</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>sub _init_if_you_need { # {{{
</td></tr><tr><td class=head>251</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    # Do We need to initialize anything?
</td></tr><tr><td class=head>252</td><td><div class=c4>3</div></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-branch.html#252" class=c4>100</a></td><td></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-subroutine.html#252" class=c4>3</a></td><td></td><td></td><td class=src>    if ($default_results_filename) {
</td></tr><tr><td class=head>253</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>        # No, thank You.
</td></tr><tr><td class=head>254</td><td><div class=c4>2</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        return;
</td></tr><tr><td class=head>255</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    }
</td></tr><tr><td class=head>256</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>257</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    # Prepare basename for the default files:
</td></tr><tr><td class=head>258</td><td><div class=c4>1</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>    my ( $basename ) = ( $PROGRAM_NAME =~ m{([^\/\\]+?)\..*$}s );
</td></tr><tr><td class=head>259</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>260</td><td><div class=c4>1</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>    $default_reference_filename = $Bin . q{/} . $basename . q{.} . $serializer_ext;
</td></tr><tr><td class=head>261</td><td><div class=c4>1</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>    $default_results_filename   = $Bin . q{/} . $basename . q{-result.} . $serializer_ext;
</td></tr><tr><td class=head>262</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>263</td><td><div class=c4>1</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>    return;
</td></tr><tr><td class=head>264</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>} # }}}
</td></tr><tr><td class=head>265</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>266</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>sub _clean_up { # {{{
</td></tr><tr><td class=head>267</td><td><div class=c4>1</div></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-branch.html#267" class=c1>50</a></td><td></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-subroutine.html#267" class=c4>1</a></td><td></td><td></td><td class=src>    if (-f $default_results_filename) {
</td></tr><tr><td class=head>268</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        unlink $default_results_filename;
</td></tr><tr><td class=head>269</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    }
</td></tr><tr><td class=head>270</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>271</td><td><div class=c4>1</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>    return;
</td></tr><tr><td class=head>272</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>}  # }}}
</td></tr><tr><td class=head>273</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>274</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=head1 REFERENCE FILES
</td></tr><tr><td class=head>275</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>276</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Reference files are data dumps using - by default - YAML::Syck.
</td></tr><tr><td class=head>277</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>278</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=over
</td></tr><tr><td class=head>279</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>280</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=item Default reference file
</td></tr><tr><td class=head>281</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>282</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Default reference file contains data for C&lt;is_referenced_ok&gt; tests.
</td></tr><tr><td class=head>283</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Each test has it's own key in the file. For the following example test:
</td></tr><tr><td class=head>284</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>285</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> is_referenced_ok(\%ENV, 'env');
</td></tr><tr><td class=head>286</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> is_referenced_ok(\@INC, 'inc');
</td></tr><tr><td class=head>287</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>288</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>...we have the following reference file:
</td></tr><tr><td class=head>289</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>290</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> ---
</td></tr><tr><td class=head>291</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> env:
</td></tr><tr><td class=head>292</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>   LANG: pl_PL
</td></tr><tr><td class=head>293</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>   LANGUAGE: pl_PL
</td></tr><tr><td class=head>294</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>   LC_ALL: pl_PL.UTF-8
</td></tr><tr><td class=head>295</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> inc:
</td></tr><tr><td class=head>296</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>   /usr/lib/perl5/site_perl
</td></tr><tr><td class=head>297</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>   /usr/lib/perl5/vendor_perl/5.10.1
</td></tr><tr><td class=head>298</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>   /usr/lib/perl5/vendor_perl
</td></tr><tr><td class=head>299</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>   /usr/lib/perl5/5.10.1
</td></tr><tr><td class=head>300</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>301</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Name for the reference file is based on the tests's filename, with I&lt;.t&gt; replaced with extension native to the used dumper.
</td></tr><tr><td class=head>302</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Example: if default serializer (YAML::Syck) is used, F&lt;foo/bar.t&gt; will use F&lt;foo/bar.yaml&gt;.
</td></tr><tr><td class=head>303</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>304</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=cut
</td></tr><tr><td class=head>305</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>306</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>sub _load_reference_if_you_need { # {{{
</td></tr><tr><td class=head>307</td><td><div class=c4>3</div></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-branch.html#307" class=c4>100</a></td><td></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-subroutine.html#307" class=c4>3</a></td><td></td><td></td><td class=src>    if ($reference) {
</td></tr><tr><td class=head>308</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>        # Reference already loaded or initialized.
</td></tr><tr><td class=head>309</td><td><div class=c4>2</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        return $reference;
</td></tr><tr><td class=head>310</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    }
</td></tr><tr><td class=head>311</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>312</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    # Is there a reference file?
</td></tr><tr><td class=head>313</td><td><div class=c4>1</div></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-branch.html#313" class=c1>50</a></td><td></td><td></td><td></td><td></td><td class=src>    if (not -f $default_reference_filename) {
</td></tr><tr><td class=head>314</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>        # Nope. Warn the User, but don't make a tragedy of it.
</td></tr><tr><td class=head>315</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        diag("No reference file found. All calls to is_referenced_ok WILL fail.");
</td></tr><tr><td class=head>316</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>317</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        return $reference = {};
</td></tr><tr><td class=head>318</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    }
</td></tr><tr><td class=head>319</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>320</td><td><div class=c4>1</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>    return $reference = $serializer_load-&gt;($default_reference_filename);
</td></tr><tr><td class=head>321</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>} # }}}
</td></tr><tr><td class=head>322</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>323</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=item Custom reference files
</td></tr><tr><td class=head>324</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>325</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Custom reference files are used by C&lt;is_referenced_in_file&gt; function. Each file contains reference data
</td></tr><tr><td class=head>326</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>for single test case. For the following example test:
</td></tr><tr><td class=head>327</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>328</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> is_referenced_in_file(\%ENV, 'env', 'environment');
</td></tr><tr><td class=head>329</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>330</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>...we have the following reference file, named F&lt;environment.yaml&gt;:
</td></tr><tr><td class=head>331</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>332</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> ---
</td></tr><tr><td class=head>333</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> LANG: pl_PL
</td></tr><tr><td class=head>334</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> LANGUAGE: pl_PL
</td></tr><tr><td class=head>335</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> LC_ALL: pl_PL.UTF-8
</td></tr><tr><td class=head>336</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>337</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=back
</td></tr><tr><td class=head>338</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>339</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=head1 TEST FAILURES
</td></tr><tr><td class=head>340</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>341</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>If there are differences between referenced, and actual data, at the end of the test prompt will be printed, similar to:
</td></tr><tr><td class=head>342</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>343</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> Resulting and reference files differ. To see differences run one of:
</td></tr><tr><td class=head>344</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>       diff foo-results.yaml foo.yaml
</td></tr><tr><td class=head>345</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>   gvimdiff foo-results.yaml foo.yaml
</td></tr><tr><td class=head>346</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> 
</td></tr><tr><td class=head>347</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> If the differences ware intended, reference data can be updated by running:
</td></tr><tr><td class=head>348</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>         mv foo-results.yaml foo.yaml
</td></tr><tr><td class=head>349</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>350</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>If there is no F&lt;foo.yaml&gt; yet (first test run, for example) then the message will be similar to:
</td></tr><tr><td class=head>351</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> 
</td></tr><tr><td class=head>352</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> No reference file found. It'a a good idea to create one from scratch manually.
</td></tr><tr><td class=head>353</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> To inspect current results run:
</td></tr><tr><td class=head>354</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>        cat foo-results.yaml
</td></tr><tr><td class=head>355</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>356</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> If You trust Your test output, You can use it to initialize deference file, by running:
</td></tr><tr><td class=head>357</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>         mv foo-results.yaml foo.yaml
</td></tr><tr><td class=head>358</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>359</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>In this case, the first time is_referenced_ok is used, it will dump the following diagnostic message:
</td></tr><tr><td class=head>360</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>361</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> No reference file found. All calls to is_referenced_ok WILL fail.
</td></tr><tr><td class=head>362</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>363</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>This is to ensure, that the User get's the idea, that something is not OK,
</td></tr><tr><td class=head>364</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>even if - for some reason - the END block does not run.
</td></tr><tr><td class=head>365</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>366</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=cut
</td></tr><tr><td class=head>367</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>368</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>sub _display_failure_prompt { # {{{
</td></tr><tr><td class=head>369</td><td><div class=c0>0</div></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-branch.html#369" class=c0>0</a></td><td></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-subroutine.html#369" class=c0>0</a></td><td></td><td></td><td class=src>    if ($ENV{'FILE_REFERENCED_NO_PROMPT'}) {
</td></tr><tr><td class=head>370</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        return;
</td></tr><tr><td class=head>371</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    }
</td></tr><tr><td class=head>372</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>373</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    # We basically have two use cases:
</td></tr><tr><td class=head>374</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    #   1) reference exist, but there are changes.
</td></tr><tr><td class=head>375</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    #   2) reference does not exist at all
</td></tr><tr><td class=head>376</td><td><div class=c0>0</div></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-branch.html#376" class=c0>0</a></td><td></td><td></td><td></td><td></td><td class=src>    if (-f $default_reference_filename) {
</td></tr><tr><td class=head>377</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>        # First major use case: reference exist, but there are changes.
</td></tr><tr><td class=head>378</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>379</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        my @shell_path = split /:/s, $ENV{'PATH'};
</td></tr><tr><td class=head>380</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>381</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        diag("Resulting and reference files differ. To see differences run one of:");
</td></tr><tr><td class=head>382</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        diag(sprintf(q{%10s %s %s}, q{diff}, $default_results_filename, $default_reference_filename));
</td></tr><tr><td class=head>383</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        foreach my $diff_command (qw( vimdiff gvimdiff kdiff )) {
</td></tr><tr><td class=head>384</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>            foreach my $path (@shell_path) {
</td></tr><tr><td class=head>385</td><td><div class=c0>0</div></td><td><a href="blib-lib-Test-FileReferenced-pm-1274985942.6920.34167-branch.html#385" class=c0>0</a></td><td></td><td></td><td></td><td></td><td class=src>                if (-x $path . q{/}. $diff_command) {
</td></tr><tr><td class=head>386</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>                    diag(sprintf(q{%10s %s %s}, $diff_command, $default_results_filename, $default_reference_filename));
</td></tr><tr><td class=head>387</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>                    last;
</td></tr><tr><td class=head>388</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>                }
</td></tr><tr><td class=head>389</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>            }
</td></tr><tr><td class=head>390</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>        }
</td></tr><tr><td class=head>391</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        diag("\n");
</td></tr><tr><td class=head>392</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        diag("If the differences ware intended, reference data can be updated by running:");
</td></tr><tr><td class=head>393</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        diag(sprintf(q{%10s %s %s}, q{mv}, $default_results_filename, $default_reference_filename));
</td></tr><tr><td class=head>394</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    }
</td></tr><tr><td class=head>395</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    else {
</td></tr><tr><td class=head>396</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>        # Second major use case: reference does not exist at all.
</td></tr><tr><td class=head>397</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        diag("No reference file found. It'a a good idea to create one from scratch manually.");
</td></tr><tr><td class=head>398</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        diag("To inspect current results run:");
</td></tr><tr><td class=head>399</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        diag(sprintf(q{%10s %s %s}, "cat", $default_results_filename));
</td></tr><tr><td class=head>400</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        diag("\n");
</td></tr><tr><td class=head>401</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        diag("If You trust Your test output, You can use it to initialize deference file, by running:");
</td></tr><tr><td class=head>402</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>        diag(sprintf(q{%10s %s %s}, q{mv}, $default_results_filename, $default_reference_filename));
</td></tr><tr><td class=head>403</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>    }
</td></tr><tr><td class=head>404</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>405</td><td><div class=c0>0</div></td><td></td><td></td><td></td><td></td><td></td><td class=src>    return;
</td></tr><tr><td class=head>406</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>} # }}}
</td></tr><tr><td class=head>407</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>408</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=head1 CUSTOM COMPARIZON ROUTINES
</td></tr><tr><td class=head>409</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>410</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>For the moment, it's an undocumented, experimental feature. Use at Your own risk.
</td></tr><tr><td class=head>411</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>412</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=head1 TDD
</td></tr><tr><td class=head>413</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>414</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Test-driven development is possible with Test::FileReferenced. One of the ways, is to follow the following steps:
</td></tr><tr><td class=head>415</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>416</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=over
</td></tr><tr><td class=head>417</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>418</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=item Initialize reference files
</td></tr><tr><td class=head>419</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>420</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>To initialize the reference file(s), run a script similar to the example bellow:
</td></tr><tr><td class=head>421</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>422</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> #!/usr/bin/perl -w
</td></tr><tr><td class=head>423</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> use strict;
</td></tr><tr><td class=head>424</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> use Test::More tests=&gt;3;
</td></tr><tr><td class=head>425</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> use Test::FileReferenced;
</td></tr><tr><td class=head>426</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>427</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> is_referenced_ok(undef, "First test");
</td></tr><tr><td class=head>428</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> is_referenced_ok(undef, "Second test");
</td></tr><tr><td class=head>429</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>430</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> is_referenced_in_file(undef, "foo", "Second test");
</td></tr><tr><td class=head>431</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>432</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>This example will create an empty default reference file for the test, and one ('foo.yaml') custom reference file.
</td></tr><tr><td class=head>433</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>434</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=item Fill reference files
</td></tr><tr><td class=head>435</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>436</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>At this point, test should pass cleanly. Our goal is to write the data structures, that We expect to have, into reference files created above.
</td></tr><tr><td class=head>437</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>438</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>After doing this, test will no longer pass.
</td></tr><tr><td class=head>439</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>440</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=item Generate test data
</td></tr><tr><td class=head>441</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>442</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>At this point, test fails because test script provides incorrect data: undef's have to be replaced with actual data - probably generated by calls to tested subroutines.
</td></tr><tr><td class=head>443</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>444</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=item Implement tested code
</td></tr><tr><td class=head>445</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>446</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>At this point, test still fails. Tested subroutines have to be properly implemented. Once this is done, test should pass, and the process is completed.
</td></tr><tr><td class=head>447</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>448</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=back
</td></tr><tr><td class=head>449</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>450</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=cut
</td></tr><tr><td class=head>451</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>452</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>1;
</td></tr><tr><td class=head>453</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>454</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>__END__
</td></tr><tr><td class=head>455</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>456</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=back
</td></tr><tr><td class=head>457</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>458</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=head1 CAVEATS
</td></tr><tr><td class=head>459</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>460</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Most caveats listed here will - most probably - apply to any other Test module.
</td></tr><tr><td class=head>461</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>They have been listed for convenience, as they have been been found to be the most common issues a Developer might run into, while using Test::FileReferenced.
</td></tr><tr><td class=head>462</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>463</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=over
</td></tr><tr><td class=head>464</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>465</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=item Random ordering
</td></tr><tr><td class=head>466</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>467</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Note, that Test::FileReferenced does not sort the data. If Your data is returned in random order (order is not actually important),
</td></tr><tr><td class=head>468</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>You should use the following:
</td></tr><tr><td class=head>469</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>470</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src> is_referenced_ok( [ sort @randomly_ordered_data ], "Test 01" )
</td></tr><tr><td class=head>471</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>472</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=item Date and/or time
</td></tr><tr><td class=head>473</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>474</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Your reference data is 'frozen' as it is in given time point. If results contain some elements derived from date/time,
</td></tr><tr><td class=head>475</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>they will be different each time You run the test. This will most likely create false negative results.
</td></tr><tr><td class=head>476</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>477</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=item Host-based data
</td></tr><tr><td class=head>478</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>479</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>If Your test data contains some host-related data (URLs), tests will pass on Your host, but will probably fail on other machines.
</td></tr><tr><td class=head>480</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>481</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=back
</td></tr><tr><td class=head>482</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>483</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>head1 KNOWN ISSUES / TODO
</td></tr><tr><td class=head>484</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>485</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=over
</td></tr><tr><td class=head>486</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>487</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=item Non unique result files
</td></tr><tr><td class=head>488</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>489</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Result files should be unique (add PID? Timestamp?), so it is possible to run the same test in two copies at a time.
</td></tr><tr><td class=head>490</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>At the moment race conditions may happen. This does not seem to be a common use case, but still.
</td></tr><tr><td class=head>491</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>492</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Will be fixed in next (0.02) version.
</td></tr><tr><td class=head>493</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>494</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=item External tmp directory
</td></tr><tr><td class=head>495</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>496</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>At the moment, result files are written in the same directory as tests, which may not always be writable by the test.
</td></tr><tr><td class=head>497</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>This should be solved by using '/tmp', or any other User-supplied directory.
</td></tr><tr><td class=head>498</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>499</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Will be fixed in next (0.02) version.
</td></tr><tr><td class=head>500</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>501</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=back
</td></tr><tr><td class=head>502</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>503</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=head1 SEE ALSO
</td></tr><tr><td class=head>504</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>505</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Test::More
</td></tr><tr><td class=head>506</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>507</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Test::FileReferenced::Deep (WIP)
</td></tr><tr><td class=head>508</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>509</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Test::FileReferenced::Framework (WIP)
</td></tr><tr><td class=head>510</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>511</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=head1 COPYRIGHT
</td></tr><tr><td class=head>512</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>513</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>Copyright 2010, Bartłomiej Syguła (natanael@natanael.krakow.pl)
</td></tr><tr><td class=head>514</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>515</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>This is free software. It is licensed, and can be distributed under the same terms as Perl itself.
</td></tr><tr><td class=head>516</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>517</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>For more, see my website: http://natanael.krakow.pl/
</td></tr><tr><td class=head>518</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>519</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>=cut
</td></tr><tr><td class=head>520</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src>
</td></tr><tr><td class=head>521</td><td></td><td></td><td></td><td></td><td></td><td></td><td class=src># vim: fdm=marker
</td></tr><tr class=summary><td class=head>521</td><td><div class=c1>51.9%</div></td><td><div class=c0>38.9%</div></td><td><div class=c0>0.0%</div></td><td><div class=c2>82.4%</div></td><td><div class=c4>100.0%</div></td><td><div class=c0>n/a</div></td><td class=src></td></tr></table>
<div class=footer>Generated by Devel::CoverReport v0.03 &copy; Bartłomiej Syguła</div>
</body>
</html>